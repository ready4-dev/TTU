<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transfer to Utility Exploratory Analysis Workflow • TTU</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Transfer to Utility Exploratory Analysis Workflow">
<meta property="og:description" content="TTU">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TTU</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9267</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TTU.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CSP_AQOL6D_TTU.html">Reporting Workflow, AQoL-6D Clinical Population Example</a>
    </li>
    <li>
      <a href="../articles/CSP_EQ5D_TTU.html">Reporting Workflow, EQ5D General Population Example</a>
    </li>
    <li>
      <a href="../articles/Model_TTU.html">Transfer to Utility Exploratory Analysis Workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ready4-dev/TTU/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Model_TTU_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Model_TTU_files/kePrint-0.0.1/kePrint.js"></script><link href="Model_TTU_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Transfer to Utility Exploratory Analysis Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ready4-dev/TTU/blob/master/vignettes/Model_TTU.Rmd"><code>vignettes/Model_TTU.Rmd</code></a></small>
      <div class="hidden name"><code>Model_TTU.Rmd</code></div>

    </div>

    
    
<p>The steps in this exploratory analysis workflow may need to be performed iteratively, both in order to identify the optimal model types, predictors and covariates to use and modify default values to ensure model convergence. Once you are satisfied that you have identified the optimal set of input values, you can implement the <a href="CSP_EQ5D_TTU.html">analysis, reporting and dissemination workflow</a> described in another vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ready4-dev.github.io/TTU/">TTU</a></span><span class="op">)</span></code></pre></div>
<div id="set-up-workspace" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up-workspace" class="anchor"></a>Set-up workspace</h2>
<p>To facilitate reproducibility, we begin by setting a seed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seed_1L_int</span> <span class="op">=</span> <span class="fl">12345</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed_1L_int</span><span class="op">)</span></code></pre></div>
<p>We next create a directory in which we will write all output.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_to_write_to_1L_chr</span> <span class="op">&lt;-</span> <span class="st">"Output"</span> 
<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">path_to_write_to_1L_chr</span><span class="op">)</span></code></pre></div>
</div>
<div id="import-and-describe-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-describe-data" class="anchor"></a>Import and describe data</h2>
<p>We import our data - in this example we are using fake data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://dataverse.harvard.edu/api/access/datafile/4750597"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The dataset we are using has 1786 records on 1068 study participants. The first six records are reproduced below.</p>
<table class="table  lightable-paper lightable-hover">
<caption>
Input dataset
</caption>
<thead><tr>
<th style="text-align:left;">
uid
</th>
<th style="text-align:right;">
Timepoint
</th>
<th style="text-align:right;">
data_collection_dtm
</th>
<th style="text-align:right;">
d_age
</th>
<th style="text-align:right;">
Gender
</th>
<th style="text-align:right;">
d_sex_birth_s
</th>
<th style="text-align:left;">
d_sexual_ori_s
</th>
<th style="text-align:right;">
d_relation_s
</th>
<th style="text-align:right;">
d_ATSI
</th>
<th style="text-align:right;">
CALD
</th>
<th style="text-align:right;">
Region
</th>
<th style="text-align:right;">
d_studying_working
</th>
<th style="text-align:left;">
eq5dq_MO
</th>
<th style="text-align:right;">
eq5dq_SC
</th>
<th style="text-align:right;">
eq5dq_UA
</th>
<th style="text-align:right;">
eq5dq_PD
</th>
<th style="text-align:right;">
eq5dq_AD
</th>
<th style="text-align:right;">
k10_int
</th>
<th style="text-align:left;">
psych_well_int
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-10-22
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
Male
</td>
<td style="text-align:right;">
Male
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
No
</td>
<td style="text-align:right;">
No
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Not studying or working
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
87
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-10-17
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Regional
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
FUP
</td>
<td style="text-align:right;">
2020-02-14
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Regional
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
71
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2020-02-15
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
Not in a relationship
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
74
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
FUP
</td>
<td style="text-align:right;">
2020-06-14
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
Not in a relationship
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
64
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-12-14
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Not studying or working
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
40
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>We next create a lookup table summarising key information about the variables from our dataset that we will explore as candidate predictors in our models. The predictors lookup table must be of the <code>TTU_predictors_lup</code> class.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predictors_lup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TTU_predictors_lup.html">TTU_predictors_lup</a></span><span class="op">(</span><span class="fu"><a href="../reference/make_pt_TTU_predictors_lup.html">make_pt_TTU_predictors_lup</a></span><span class="op">(</span>short_name_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"k10_int"</span>,<span class="st">"psych_well_int"</span><span class="op">)</span>,
                                              long_name_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kessler Psychological Distress - 10 Item Total Score"</span>,
                                                   <span class="st">"Overall Wellbeing Measure (Winefield et al. 2012)"</span><span class="op">)</span>,
                                              min_val_dbl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">18</span><span class="op">)</span>,
                                              max_val_dbl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">90</span><span class="op">)</span>,
                                              class_chr <span class="op">=</span> <span class="st">"integer"</span>,
                                              increment_dbl <span class="op">=</span> <span class="fl">1</span>,
                                              class_fn_chr <span class="op">=</span> <span class="st">"as.integer"</span>,
                                              mdl_scaling_dbl <span class="op">=</span> <span class="fl">0.01</span>,
                                              covariate_lgl <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We also require a data dictionary for our input dataset. The dictionary must be of the <code><a href="https://ready4-dev.github.io/ready4use/reference/ready4_dictionary.html">ready4use::ready4_dictionary</a></code> class. In the example below we are using an existing dictionary.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dictionary_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_eq5d_ds_dict.html">make_eq5d_ds_dict</a></span><span class="op">(</span><span class="va">data_tb</span>,
                                   predictors_lup <span class="op">=</span> <span class="va">predictors_lup</span><span class="op">)</span></code></pre></div>
</div>
<div id="score-utility-and-summarise-meta-data" class="section level2">
<h2 class="hasAnchor">
<a href="#score-utility-and-summarise-meta-data" class="anchor"></a>Score utility and summarise meta-data</h2>
<p>We now convert study participant responses to the EQ-5D questionnaire to health utility scores. We do this using the <code>eq5d</code> package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fragla/eq5d">eq5d</a></span><span class="op">)</span>
<span class="va">data_tb</span> <span class="op">&lt;-</span> <span class="va">data_tb</span> <span class="op">%&gt;%</span> 
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">.x</span>,<span class="st">"eq5dq_"</span>,<span class="st">""</span><span class="op">)</span>,<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"eq5dq_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu">`:=`</span><span class="op">(</span><span class="va">EQ5D_total_dbl</span>, 
                     <span class="fu">eq5d</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eq5d/man/eq5d.html">eq5d</a></span><span class="op">(</span><span class="va">.</span>, country<span class="op">=</span><span class="st">"UK"</span>, version <span class="op">=</span> <span class="st">"5L"</span>, type <span class="op">=</span> <span class="st">"CW"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"eq5dq_"</span>,<span class="va">.x</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MO"</span>,<span class="st">"SC"</span>,<span class="st">"UA"</span>,<span class="st">"PD"</span>,<span class="st">"AD"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can label dataset variables using descriptions from the data dictionary.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span> <span class="op">&lt;-</span> <span class="va">data_tb</span> <span class="op">%&gt;%</span>
  <span class="fu">ready4use</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4use/reference/add_labels_from_dictionary.html">add_labels_from_dictionary</a></span><span class="op">(</span>dictionary_tb <span class="op">=</span> <span class="va">dictionary_tb</span>,
                                        remove_old_lbls_1L_lgl <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> </code></pre></div>
<p>The first six records of the scored and labelled dataset are reproduced below.</p>
<table class="table  lightable-paper lightable-hover">
<caption>
Scored and labelled dataset
</caption>
<thead><tr>
<th style="text-align:left;">
Unique identifier
</th>
<th style="text-align:right;">
Data collection round
</th>
<th style="text-align:right;">
Date of data collection
</th>
<th style="text-align:right;">
Age
</th>
<th style="text-align:right;">
Gender (Grouped)
</th>
<th style="text-align:right;">
Sex at Birth
</th>
<th style="text-align:left;">
Sexual Orientation
</th>
<th style="text-align:right;">
Relationship Status
</th>
<th style="text-align:right;">
Aboriginal or Torres Strait Islander
</th>
<th style="text-align:right;">
Culturally And Linguistically Diverse
</th>
<th style="text-align:right;">
Region of Residence (Metropolitan or Regional)
</th>
<th style="text-align:right;">
Education and Employment Status
</th>
<th style="text-align:left;">
EQ5D - Mobility domain score
</th>
<th style="text-align:right;">
EQ5D - Self-Care domain score
</th>
<th style="text-align:right;">
EQ5D - Usual Activities domain score
</th>
<th style="text-align:right;">
EQ5D - Pain / Discomfort domain score
</th>
<th style="text-align:right;">
EQ5D - Anxiety / Depression domain score
</th>
<th style="text-align:right;">
Kessler Psychological Distress - 10 Item Total Score
</th>
<th style="text-align:left;">
Overall Wellbeing Measure (Winefield et al. 2012)
</th>
<th style="text-align:right;">
EQ5D - total weighted score
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-10-22
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
Male
</td>
<td style="text-align:right;">
Male
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
No
</td>
<td style="text-align:right;">
No
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Not studying or working
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
87
</td>
<td style="text-align:right;">
0.879
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-10-17
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Regional
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
65
</td>
<td style="text-align:right;">
0.846
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
FUP
</td>
<td style="text-align:right;">
2020-02-14
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Regional
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
71
</td>
<td style="text-align:right;">
0.850
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2020-02-15
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
Not in a relationship
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
74
</td>
<td style="text-align:right;">
0.883
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
FUP
</td>
<td style="text-align:right;">
2020-06-14
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
Not in a relationship
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Studying only
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:right;">
0.906
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
BL
</td>
<td style="text-align:right;">
2019-12-14
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:right;">
Female
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:right;">
In a relationship
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Yes
</td>
<td style="text-align:right;">
Metro
</td>
<td style="text-align:right;">
Not studying or working
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
40
</td>
<td style="text-align:right;">
0.796
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>We next create an object <code>ds_smry_ls</code> to store a description of some structural properties of the dataset such as:</p>
<ul>
<li>the name of the dependent variable (ie total health utility score);</li>
<li>the names of the variables we will be exploring as candidate predictors and as candidate covariates in our modelling;</li>
<li>the candidate predictors look-up table that we previously created;</li>
<li>the names of the variables for unique participant identifier and data collection round; and</li>
<li>the value of the data collection round variable for the baseline timepoint.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_smry_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_ds_smry_ls.html">make_ds_smry_ls</a></span><span class="op">(</span>candidate_predrs_chr <span class="op">=</span> <span class="va">predictors_lup</span><span class="op">$</span><span class="va">short_name_chr</span>,
                              candidate_covar_nms_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d_sex_birth_s"</span>, <span class="st">"d_age"</span>,  <span class="st">"d_sexual_ori_s"</span>, <span class="st">"d_relation_s"</span>, <span class="st">"d_studying_working"</span><span class="op">)</span>,
                              depnt_var_nm_1L_chr <span class="op">=</span> <span class="st">"EQ5D_total_dbl"</span>,
                              dictionary_tb <span class="op">=</span> <span class="va">dictionary_tb</span>,
                              id_var_nm_1L_chr <span class="op">=</span> <span class="st">"uid"</span>,
                              round_var_nm_1L_chr <span class="op">=</span> <span class="st">"Timepoint"</span>,
                              round_bl_val_1L_chr <span class="op">=</span> <span class="st">"BL"</span>,
                              predictors_lup <span class="op">=</span> <span class="va">predictors_lup</span><span class="op">)</span></code></pre></div>
</div>
<div id="test-candidate-models-predictors-and-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#test-candidate-models-predictors-and-covariates" class="anchor"></a>Test candidate models, predictors and covariates</h2>
<p>Our first analytic task is to test which models, predictors and covariates perform best. This tasks can be broken down into the following steps.</p>
<div id="preliminary-tasks" class="section level3">
<h3 class="hasAnchor">
<a href="#preliminary-tasks" class="anchor"></a>Preliminary tasks</h3>
<p>We begin by reviewing the <code>TTU</code> packages lookup table of types of models we can test.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdl_types_lup</span> <span class="op">&lt;-</span> <span class="fu">TTU</span><span class="fu">::</span><span class="fu"><a href="../reference/get_cndts_for_mxd_mdls.html">get_cndts_for_mxd_mdls</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">mdl_types_lup</span> <span class="op">%&gt;%</span>
    <span class="fu">ready4show</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4show/reference/print_table.html">print_table</a></span><span class="op">(</span>output_type_1L_chr <span class="op">=</span> <span class="st">"HTML"</span>,
                          caption_1L_chr <span class="op">=</span> <span class="st">"Model types lookup table"</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Model types lookup table
</caption>
<thead><tr>
<th style="text-align:left;">
short_name_chr
</th>
<th style="text-align:right;">
long_name_chr
</th>
<th style="text-align:right;">
control_chr
</th>
<th style="text-align:right;">
family_chr
</th>
<th style="text-align:right;">
fn_chr
</th>
<th style="text-align:right;">
start_chr
</th>
<th style="text-align:right;">
predn_type_chr
</th>
<th style="text-align:right;">
tfmn_chr
</th>
<th style="text-align:left;">
tfmn_for_bnml_lgl
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
OLS_NTF
</td>
<td style="text-align:right;">
Ordinary Least Squares (No transformation)
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
lm
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NTF
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
OLS_LOG
</td>
<td style="text-align:right;">
Ordinary Least Squares (Log transformation)
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
lm
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
LOG
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
OLS_LOGIT
</td>
<td style="text-align:right;">
Ordinary Least Squares (Logit transformation)
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
lm
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
LOGIT
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
OLS_LOGLOG
</td>
<td style="text-align:right;">
Ordinary Least Squares (Log Log transformation)
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
lm
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
LOGLOG
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
OLS_CLL
</td>
<td style="text-align:right;">
Ordinary Least Squares (Complementary Log Log transformation)
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
lm
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
CLL
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
GLM_GSN_LOG
</td>
<td style="text-align:right;">
Generalised Linear Mixed Model with Gaussian distribution and log link
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
gaussian(log)
</td>
<td style="text-align:right;">
glm
</td>
<td style="text-align:right;">
-0.1,-0.1
</td>
<td style="text-align:right;">
response
</td>
<td style="text-align:right;">
NTF
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
BET_LGT
</td>
<td style="text-align:right;">
Beta Regression Model with Binomial distribution and logit link
</td>
<td style="text-align:right;">
betareg::betareg.control
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
betareg::betareg
</td>
<td style="text-align:right;">
-0.5,-0.1,3
</td>
<td style="text-align:right;">
response
</td>
<td style="text-align:right;">
NTF
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
BET_CLL
</td>
<td style="text-align:right;">
Beta Regression Model with Binomial distribution and complementary log log link
</td>
<td style="text-align:right;">
betareg::betareg.control
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
betareg::betareg
</td>
<td style="text-align:right;">
-0.5,-0.1,3
</td>
<td style="text-align:right;">
response
</td>
<td style="text-align:right;">
NTF
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>We modify this table as appropriate (in the below example, we leave it unchanged). We then add the lookup table to a new object, <code>mdl_smry_ls</code> which stores information about the candidate models we will be using.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdl_smry_ls</span> <span class="op">&lt;-</span> <span class="va">mdl_types_lup</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/make_mdl_smry_ls.html">make_mdl_smry_ls</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_mdl_cmprsn.html">write_mdl_cmprsn</a></span><span class="op">(</span>scored_data_tb <span class="op">=</span> <span class="va">data_tb</span>,
                                ds_smry_ls <span class="op">=</span> <span class="va">ds_smry_ls</span>,
                                mdl_smry_ls <span class="op">=</span> <span class="va">mdl_smry_ls</span>,
                                output_data_dir_1L_chr <span class="op">=</span> <span class="va">path_to_write_to_1L_chr</span>,
                                seed_1L_int <span class="op">=</span> <span class="va">seed_1L_int</span><span class="op">)</span></code></pre></div>
<p>The <code>write_mdl_cmprsn</code> function will write each model to be tested to a new sub-directory of “Output” called “A_Candidate_Mdls_Cmprsn”. Also written to that sub-directory are a number of plots for each model. The <code>write_mdl_cmprsn</code> function also outputs a table summarising the performance of each of the candidate models.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">smry_of_sngl_predr_mdls_tb</span> <span class="op">%&gt;%</span>
  <span class="fu">ready4show</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4show/reference/print_table.html">print_table</a></span><span class="op">(</span>output_type_1L_chr <span class="op">=</span> <span class="st">"HTML"</span>,
                          caption_1L_chr <span class="op">=</span> <span class="st">"Comparison of model types for highest correlated predictor using baseline data"</span>,
                          mkdn_tbl_ref_1L_chr <span class="op">=</span> <span class="st">"tab:mdl_cmprsn"</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Comparison of model types for highest correlated predictor using baseline data
</caption>
<thead><tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
Rsquared
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
RsquaredP
</th>
<th style="text-align:right;">
RMSEP
</th>
<th style="text-align:right;">
MAEP
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Beta Regression Model with Binomial distribution and logit link
</td>
<td style="text-align:right;">
0.4256336
</td>
<td style="text-align:right;">
0.0750881
</td>
<td style="text-align:right;">
0.0592085
</td>
<td style="text-align:right;">
0.4065157
</td>
<td style="text-align:right;">
0.0749468
</td>
<td style="text-align:right;">
0.0592747
</td>
</tr>
<tr>
<td style="text-align:left;">
Beta Regression Model with Binomial distribution and complementary log log link
</td>
<td style="text-align:right;">
0.4119537
</td>
<td style="text-align:right;">
0.0759786
</td>
<td style="text-align:right;">
0.0598996
</td>
<td style="text-align:right;">
0.3938732
</td>
<td style="text-align:right;">
0.0758661
</td>
<td style="text-align:right;">
0.0599625
</td>
</tr>
<tr>
<td style="text-align:left;">
Ordinary Least Squares (No transformation)
</td>
<td style="text-align:right;">
0.4079463
</td>
<td style="text-align:right;">
0.0762376
</td>
<td style="text-align:right;">
0.0599796
</td>
<td style="text-align:right;">
0.3911325
</td>
<td style="text-align:right;">
0.0761514
</td>
<td style="text-align:right;">
0.0600527
</td>
</tr>
<tr>
<td style="text-align:left;">
Ordinary Least Squares (Complementary Log Log transformation)
</td>
<td style="text-align:right;">
0.3995892
</td>
<td style="text-align:right;">
0.0767730
</td>
<td style="text-align:right;">
0.0605442
</td>
<td style="text-align:right;">
0.3803300
</td>
<td style="text-align:right;">
0.0766537
</td>
<td style="text-align:right;">
0.0605794
</td>
</tr>
<tr>
<td style="text-align:left;">
Generalised Linear Mixed Model with Gaussian distribution and log link
</td>
<td style="text-align:right;">
0.3887797
</td>
<td style="text-align:right;">
0.0774636
</td>
<td style="text-align:right;">
0.0605710
</td>
<td style="text-align:right;">
0.3739220
</td>
<td style="text-align:right;">
0.0773766
</td>
<td style="text-align:right;">
0.0606410
</td>
</tr>
<tr>
<td style="text-align:left;">
Ordinary Least Squares (Log transformation)
</td>
<td style="text-align:right;">
0.3667240
</td>
<td style="text-align:right;">
0.0788503
</td>
<td style="text-align:right;">
0.0625689
</td>
<td style="text-align:right;">
0.3476110
</td>
<td style="text-align:right;">
0.0788115
</td>
<td style="text-align:right;">
0.0626548
</td>
</tr>
<tr>
<td style="text-align:left;">
Ordinary Least Squares (Logit transformation)
</td>
<td style="text-align:right;">
0.3604047
</td>
<td style="text-align:right;">
0.0792355
</td>
<td style="text-align:right;">
0.0623562
</td>
<td style="text-align:right;">
0.3381371
</td>
<td style="text-align:right;">
0.0790669
</td>
<td style="text-align:right;">
0.0623585
</td>
</tr>
<tr>
<td style="text-align:left;">
Ordinary Least Squares (Log Log transformation)
</td>
<td style="text-align:right;">
0.3473261
</td>
<td style="text-align:right;">
0.0800406
</td>
<td style="text-align:right;">
0.0629494
</td>
<td style="text-align:right;">
0.3240517
</td>
<td style="text-align:right;">
0.0798784
</td>
<td style="text-align:right;">
0.0629428
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>We can now identify the highest performing model in each category of candidate model based on the testing R<sup>2</sup> statistic (RsquaredP in the previous table).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">prefd_mdl_types_chr</span></code></pre></div>
<pre><code>## [1] "OLS_NTF"     "GLM_GSN_LOG" "BET_LGT"</code></pre>
<p>We can override these automated selections and instead incorporate other considerations (possibly based on judgments informed by visual inspection of the plots and the desirability of constraining predictions to a maximum value of one). We do this in the following command, specifying new preferred model types, in descending order of preference.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">prefd_mdl_types_chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OLS_NTF"</span>, <span class="st">"GLM_GSN_LOG"</span>, <span class="st">"BET_CLL"</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-most-preferred-model-to-compare-all-candidate-predictors" class="section level3">
<h3 class="hasAnchor">
<a href="#use-most-preferred-model-to-compare-all-candidate-predictors" class="anchor"></a>Use most preferred model to compare all candidate predictors</h3>
<p>We can now compare all of our candidate predictors (with and without candidate covariates) using the most preferred model type.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_predr_and_covars_cmprsn.html">write_predr_and_covars_cmprsn</a></span><span class="op">(</span>scored_data_tb <span class="op">=</span> <span class="va">data_tb</span>,
                                            bl_tb <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">bl_tb</span>,
                                            ds_smry_ls <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">ds_smry_ls</span>,
                                            mdl_smry_ls <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span>,
                                            output_data_dir_1L_chr <span class="op">=</span> <span class="va">path_to_write_to_1L_chr</span>,
                                            seed_1L_int <span class="op">=</span> <span class="va">seed_1L_int</span><span class="op">)</span></code></pre></div>
<p>Now, we compare the performance of single predictor models of our preferred model type (in our case, a Ordinary Least Squares (No transformation)) for each candidate predictor. The call to the <code class="sourceCode r">write_predr_and_covars_cmprsn</code> function saved the tested models along with model plots in the “B_Candidate_Predrs_Cmprsn” sub-directory of “Output”. These results are also viewable as a table.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">predr_cmprsn_tb</span> <span class="op">%&gt;%</span>
    <span class="fu">ready4show</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4show/reference/print_table.html">print_table</a></span><span class="op">(</span>output_type_1L_chr <span class="op">=</span> <span class="st">"HTML"</span>,
                          caption_1L_chr <span class="op">=</span> <span class="st">"Comparison of all candidate predictors using preferred model"</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Comparison of all candidate predictors using preferred model
</caption>
<thead><tr>
<th style="text-align:left;">
predr_chr
</th>
<th style="text-align:right;">
%IncMSE
</th>
<th style="text-align:left;">
IncNodePurity
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
k10_int
</td>
<td style="text-align:right;">
0.0065171
</td>
<td style="text-align:left;">
3.955179
</td>
</tr>
<tr>
<td style="text-align:left;">
psych_well_int
</td>
<td style="text-align:right;">
0.0010166
</td>
<td style="text-align:left;">
2.365518
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>The call to the <code class="sourceCode r">write_predr_and_covars_cmprsn</code> function also saved single predictor R model objects (one for each candidate predictors) along with the two plots for each model in the “C_Predrs_Sngl_Mdl_Cmprsn” sub-directory of “Output”. The performance of each single predictor model can also be summarised in a table.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">smry_of_mdl_sngl_predrs_tb</span> <span class="op">%&gt;%</span>
    <span class="fu">ready4show</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4show/reference/print_table.html">print_table</a></span><span class="op">(</span>output_type_1L_chr <span class="op">=</span> <span class="st">"HTML"</span>,
                          caption_1L_chr <span class="op">=</span> <span class="st">"Preferred single predictor model performance by candidate predictor"</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Preferred single predictor model performance by candidate predictor
</caption>
<thead><tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Rsquared
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:left;">
RsquaredP
</th>
<th style="text-align:right;">
RMSEP
</th>
<th style="text-align:left;">
MAEP
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
k10_int
</td>
<td style="text-align:right;">
0.4079463
</td>
<td style="text-align:left;">
0.0762376
</td>
<td style="text-align:right;">
0.0599796
</td>
<td style="text-align:left;">
0.3911325
</td>
<td style="text-align:right;">
0.0761514
</td>
<td style="text-align:left;">
0.0600527
</td>
</tr>
<tr>
<td style="text-align:left;">
psych_well_int
</td>
<td style="text-align:right;">
0.1322580
</td>
<td style="text-align:left;">
0.0923036
</td>
<td style="text-align:right;">
0.0707349
</td>
<td style="text-align:left;">
0.1167066
</td>
<td style="text-align:right;">
0.0923999
</td>
<td style="text-align:left;">
0.0708471
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>Updated versions of each of the models in the previous step (this time with covariates added) are saved to the “D_Predr_Covars_Cmprsn” subdirectory of “Output” and we can summarise the performance of each of the updated models, along with all signficant model terms, in a table.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">mdls_with_covars_smry_tb</span> <span class="op">%&gt;%</span>
    <span class="fu">ready4show</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/ready4show/reference/print_table.html">print_table</a></span><span class="op">(</span>output_type_1L_chr <span class="op">=</span> <span class="st">"HTML"</span>,
                            caption_1L_chr <span class="op">=</span> <span class="st">"Preferred performance of models with covariate predictors by candidate predictor"</span>, 
                          use_lbls_as_col_nms_1L_lgl <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Preferred performance of models with covariate predictors by candidate predictor
</caption>
<thead><tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
Rsquare
</th>
<th style="text-align:left;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:left;">
Significant
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
psych_well_int
</td>
<td style="text-align:right;">
0.1533129
</td>
<td style="text-align:left;">
-1892.712
</td>
<td style="text-align:right;">
-1843.836
</td>
<td style="text-align:left;">
(Intercept) psych_well_int
</td>
</tr>
<tr>
<td style="text-align:left;">
k10_int
</td>
<td style="text-align:right;">
0.4189650
</td>
<td style="text-align:left;">
-2261.702
</td>
<td style="text-align:right;">
-2212.826
</td>
<td style="text-align:left;">
(Intercept) k10_int
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>We can now identify which, if any, of the candidate covariates we previously specified are significant predictors in any of the models.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span><span class="op">$</span><span class="va">signt_covars_chr</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>We can override the covariates to select, potentially because we want to select only covariates that are significant for all or most of the models. However, in the below example we have opted not to do so and continue to use as selected by the algorithm in the previous step.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cmprsns_ls$mdl_smry_ls$prefd_covars_chr &lt;- c("COVARIATE WE WANT TO USE", "ANOTHER COVARIATE")</span></code></pre></div>
</div>
<div id="test-preferred-model-with-preferred-covariates-for-each-candidate-predictor" class="section level3">
<h3 class="hasAnchor">
<a href="#test-preferred-model-with-preferred-covariates-for-each-candidate-predictor" class="anchor"></a>Test preferred model with preferred covariates for each candidate predictor</h3>
<p>We now conclude our model testing by rerunning the previous step, except confining our covariates to those we prefer.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outp_smry_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_mdls_with_covars_cmprsn.html">write_mdls_with_covars_cmprsn</a></span><span class="op">(</span>scored_data_tb <span class="op">=</span> <span class="va">data_tb</span>,
                                           bl_tb <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">bl_tb</span>,
                                           ds_smry_ls <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">ds_smry_ls</span>,
                                           mdl_smry_ls <span class="op">=</span> <span class="va">cmprsns_ls</span><span class="op">$</span><span class="va">mdl_smry_ls</span>,
                                           output_data_dir_1L_chr <span class="op">=</span> <span class="va">path_to_write_to_1L_chr</span>,
                                           seed_1L_int <span class="op">=</span> <span class="va">seed_1L_int</span><span class="op">)</span></code></pre></div>
<p>The previous call to the <code class="sourceCode r">write_mdls_with_covars_cmprsn</code> function saves the tested models along with the two plots for each model in the “E_Predrs_W_Covars_Sngl_Mdl_Cmprsn” sub-directory of “Output”.</p>
</div>
</div>
<div id="apply-preferred-model-types-and-predictors-to-time-series-data" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-preferred-model-types-and-predictors-to-time-series-data" class="anchor"></a>Apply preferred model types and predictors to time series data</h2>
<p>The next main step is to use the preferred model types and covariates identified from the preceding analysis of cross-sectional data in time series analysis.</p>
<div id="time-series-modelling" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-modelling" class="anchor"></a>Time series modelling</h3>
<p>Next we test each of the time series models we specified in the previous step. Note, that in many cases both the <code>prior_ls</code> and <code>control_ls</code> arguments can be set to <code>NULL</code> (which may speed up execution). However, in this example doing so would result in warning messages suggesting a change to the adapt_delta control value (default = 0.8). We have therefore passed a value to the <code>control_ls</code> argument that addresses this issue.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outp_smry_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_ts_mdls_from_alg_outp.html">write_ts_mdls_from_alg_outp</a></span><span class="op">(</span><span class="va">outp_smry_ls</span>,
                                            predictors_lup <span class="op">=</span> <span class="va">predictors_lup</span> ,
                                            utl_min_val_1L_dbl <span class="op">=</span> <span class="fl">0.03</span>,
                                            backend_1L_chr <span class="op">=</span> <span class="st">"cmdstanr"</span>,
                                            new_dir_nm_1L_chr <span class="op">=</span> <span class="st">"F_TS_Mdls"</span>,
                                            iters_1L_int <span class="op">=</span> <span class="fl">4000L</span>,
                                            prior_ls <span class="op">=</span> <span class="cn">NULL</span>, 
                                            control_ls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The <code class="sourceCode r">write_ts_mdls_from_alg_outp</code> function writes the models it tests to the “F_TS_Mdls” sub-directory of “Output” along with three plots for each model.</p>
</div>
</div>
<div id="purge-dataset-copies" class="section level2">
<h2 class="hasAnchor">
<a href="#purge-dataset-copies" class="anchor"></a>Purge dataset copies</h2>
<p>Because the files created in analysis are large, multiple objects containing copies of the source dataset have been saved to our output directory during the analysis process. We therefore need to delete all of these copies.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/write_to_delete_mdl_fls.html">write_to_delete_mdl_fls</a></span><span class="op">(</span><span class="va">outp_smry_ls</span><span class="op">)</span>
<span class="va">outp_smry_ls</span><span class="op">$</span><span class="va">scored_data_tb</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></code></pre></div>
</div>
<div id="save-work" class="section level2">
<h2 class="hasAnchor">
<a href="#save-work" class="anchor"></a>Save work</h2>
<p>Finally, we can save a complete record of our analysis.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">outp_smry_ls</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outp_smry_ls</span><span class="op">$</span><span class="va">path_to_write_to_1L_chr</span>,<span class="st">"/I_ALL_OUTPUT_.RDS"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Caroline Gao, Matthew Hamilton, Orygen, Headspace, National Health and Medical Research Council.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
